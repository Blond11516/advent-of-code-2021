# Day 13

## Description

https://adventofcode.com/2021/day/13

## Input

<!-- livebook:{"livebook_object":"cell_input","name":"input","type":"textarea","value":"1284,229\n713,50\n1267,194\n437,229\n651,200\n763,407\n1173,373\n248,579\n503,395\n155,532\n278,488\n863,444\n403,695\n20,25\n709,105\n1063,560\n554,94\n955,444\n897,813\n792,665\n969,799\n1293,843\n261,716\n1084,542\n33,579\n1295,656\n82,743\n1101,789\n164,506\n856,220\n199,323\n252,733\n525,669\n1292,137\n1230,756\n552,856\n1120,229\n59,42\n360,737\n346,215\n1005,285\n673,535\n1150,131\n540,177\n822,539\n301,375\n410,743\n1303,357\n1290,540\n873,574\n551,434\n875,86\n300,336\n301,560\n373,184\n1125,460\n863,28\n990,768\n360,107\n223,574\n525,491\n425,554\n191,584\n80,473\n904,138\n464,889\n530,625\n922,437\n1064,757\n74,581\n234,760\n65,149\n318,421\n873,478\n575,329\n1098,602\n964,861\n1173,145\n1201,478\n898,607\n103,404\n551,796\n628,677\n281,845\n1017,669\n1005,166\n502,292\n155,362\n1201,416\n346,543\n863,705\n141,882\n1032,488\n1026,739\n277,222\n1017,127\n494,763\n933,894\n774,229\n209,341\n1241,845\n388,9\n457,239\n808,292\n187,32\n107,407\n219,224\n739,329\n99,107\n1211,107\n785,771\n1168,130\n140,488\n170,579\n1026,563\n305,546\n609,789\n316,719\n551,404\n80,105\n1004,212\n1150,763\n1183,220\n457,655\n192,873\n676,25\n224,884\n917,268\n873,416\n214,103\n632,299\n729,334\n10,399\n1285,861\n64,611\n1272,737\n1087,294\n464,5\n323,885\n26,553\n699,194\n1135,14\n364,570\n1077,693\n561,59\n1119,584\n556,619\n277,672\n301,519\n375,189\n47,371\n1120,889\n440,103\n865,60\n373,710\n1146,219\n678,859\n572,207\n838,799\n1175,366\n375,539\n1265,481\n447,705\n355,450\n907,199\n264,791\n1066,879\n875,186\n1164,423\n1004,660\n637,330\n455,546\n59,294\n724,114\n631,750\n806,280\n774,122\n191,481\n105,281\n43,786\n315,656\n68,332\n226,542\n1076,582\n500,249\n807,395\n48,269\n1210,7\n1267,108\n410,341\n759,180\n355,5\n463,665\n390,343\n609,497\n350,819\n900,10\n1207,460\n160,763\n181,135\n599,351\n964,679\n846,565\n850,625\n1048,712\n622,793\n1114,737\n475,355\n323,773\n104,838\n175,273\n1071,624\n107,136\n1033,894\n513,684\n1037,24\n1103,556\n104,560\n349,609\n530,437\n277,448\n622,177\n1305,108\n688,126\n454,170\n536,68\n1230,138\n1101,565\n763,575\n907,155\n773,789\n490,388\n1049,821\n197,627\n731,827\n1181,655\n417,474\n1207,490\n328,673\n47,147\n1039,767\n208,730\n408,308\n228,275\n1130,810\n569,694\n127,674\n306,234\n972,791\n1036,880\n1257,789\n244,15\n1113,267\n570,336\n52,581\n1111,457\n740,336\n249,837\n637,535\n1110,110\n1039,137\n75,515\n699,481\n360,401\n187,841\n382,677\n812,763\n547,504\n282,12\n30,549\n469,168\n547,487\n17,759\n502,154\n537,105\n331,200\n78,206\n721,149\n1277,347\n940,358\n1208,9\n293,669\n349,98\n1135,51\n676,234\n454,618\n537,658\n1007,505\n1203,407\n1017,261\n867,77\n524,177\n137,749\n701,845\n1293,51\n261,452\n826,350\n611,749\n13,518\n244,553\n852,320\n1275,829\n1258,581\n17,588\n1292,757\n940,536\n783,658\n135,814\n500,197\n1288,859\n678,411\n738,53\n663,805\n1016,605\n1235,199\n1123,15\n249,445\n1203,95\n576,206\n524,871\n599,95\n79,696\n467,841\n346,257\n410,785\n656,445\n222,635\n586,887\n1093,366\n701,262\n1128,775\n1253,844\n1203,808\n938,105\n715,628\n360,23\n584,159\n1111,98\n107,127\n912,719\n537,262\n271,757\n283,189\n525,640\n756,455\n627,453\n599,112\n905,53\n587,19\n587,875\n820,281\n1091,224\n579,379\n709,789\n982,3\n898,175\n923,852\n856,170\n435,708\n354,553\n211,410\n708,581\n172,697\n1125,434\n721,477\n1110,674\n361,225\n1261,194\n242,607\n967,763\n197,267\n1251,294\n1135,273\n995,341\n1033,700\n945,700\n683,453\n164,388\n550,782\n1165,82\n763,319\n152,154\n890,516\n681,112\n1288,747\n1237,112\n904,287\n370,536\n196,31\n959,389\n994,719\n1044,9\n353,861\n170,565\n786,544\n1005,173\n48,199\n412,719\n1260,505\n1061,610\n311,686\n918,264\n197,575\n333,562\n900,553\n619,289\n1017,633\n1203,127\n699,108\n1135,499\n239,718\n1116,528\n677,434\n580,313\n753,340\n1255,858\n879,768\n595,152\n284,331\n1302,344\n1228,337\n1251,600\n1101,553\n721,865\n761,855\n731,247\n992,473\n1052,556\n249,732\n1192,826\n1119,217\n1267,332\n381,646\n681,861\n648,798\n738,574\n589,745\n108,626\n455,571\n855,348\n734,206\n574,15\n611,33\n281,565\n1033,672\n1146,388\n372,826\n129,239\n959,505\n525,771\n604,326\n525,254\n1020,324\n761,57\n1062,399\n736,809\n139,445\n874,178\n927,757\n1027,332\n904,651\n711,708\n586,780\n967,574\n383,410\n783,124\n527,12\n182,119\n595,350\n904,495\n868,527\n724,439\n574,85\n629,37\n494,355\n354,341\n1130,182\n605,110\n26,665\n294,345\n440,791\n164,675\n349,796\n1064,586\n848,21\n729,21\n271,767\n947,49\n1242,332\n1135,880\n524,289\n160,131\n590,611\n609,262\n311,208\n1026,331\n1284,553\n117,658\n786,871\n197,319\n38,849\n180,182\n890,378\n348,212\n900,743\n1052,338\n574,879\n773,632\n98,152\n421,201\n1041,141\n1293,428\n33,99\n104,334\n199,796\n479,880\n326,445\n405,53\n406,735\n572,10\n874,626\n1046,791\n816,131\n721,745\n1029,537\n194,157\n117,553\n1303,805\n145,82\n1009,71\n527,457\n445,12\n436,66\n281,632\n756,800\n875,351\n701,497\n403,739\n130,423\n1297,376\n927,86\n217,798\n1151,228\n1017,185\n686,793\n1158,154\n639,686\n1295,238\n527,460\n753,373\n1203,351\n594,130\n1061,445\n127,220\n92,582\n949,225\n43,108\n994,343\n749,611\n524,605\n607,539\n1119,677\n572,474\n345,199\n219,670\n383,86\n700,553\n1183,674\n864,164\n1248,343\n609,845\n965,199\n769,306\n1228,436\n900,781\n579,627\n45,257\n865,553\n689,449\n594,764\n900,113\n683,441\n199,437\n129,640\n1027,189\n8,550\n671,208\n1203,263\n579,827\n484,763\n80,789\n267,404\n556,152\n551,460\n445,386\n674,585\n634,234\n17,583\n917,73\n773,610\n850,533\n191,33\n634,421\n537,355\n103,852\n761,39\n490,506\n1002,33\n902,266\n900,15\n1113,627\n462,201\n773,710\n1029,49\n323,9\n435,808\n328,3\n1236,313\n880,436\n248,399\n927,484\n345,695\n1253,50\n865,147\n832,343\n556,275\n1241,49\n57,498\n301,861\n846,329\n639,126\n810,249\n938,329\n242,287\n835,355\n8,344\n1297,600\n711,95\n1101,747\n82,436\n1102,341\n45,481\n194,737\n212,154\n572,53\n222,56\n1212,152\n251,715\n847,229\n701,632\n129,571\n882,542\n1170,411\n1212,572\n431,574\n1228,743\n721,373\n1049,149\n244,879\n1251,152\n774,570\n244,501\n261,29\n841,726\n900,785\n1061,732\n359,297\n1077,201\n890,200\n214,343\n508,423\n75,871\n957,861\n1263,371\n284,603\n82,532\n301,823\n338,791\n117,777\n82,789\n464,565\n595,714\n1120,665\n107,711\n92,826\n1293,583\n331,437\n955,450\n636,585\n856,724\n1020,329\n281,243\n244,113\n691,681\n724,780\n129,403\n811,84\n847,584\n1111,12\n917,149\n396,338\n868,602\n1118,21\n1248,318\n261,745\n50,505\n228,182\n266,856\n571,329\n652,766\n1165,619\n1084,369\n10,175\n1029,262\n469,726\n1302,473\n1207,852\n326,613\n984,221\n75,199\n1001,116\n1020,220\n773,105\n55,334\n632,411\n445,60\n749,59\n611,700\n284,155\n1039,757\n917,745\n294,23\n80,565\n1102,665\n22,600\n1066,781\n47,355\n706,326\n1307,694\n1245,745\n688,793\n1066,501\n1210,455\n1168,316\n383,484\n309,535\n464,329\n627,441\n118,677\n308,861\n74,313\n386,294\n808,154\n701,413\n413,813\n98,572\n950,401\n986,19\n1285,334\n1114,157\n1226,558\n736,85\n599,543\n100,757\n808,740\n893,420\n865,834\n1228,532\n716,130\n831,843\n1248,551\n1027,114\n1230,565\n624,549\n199,571\n589,865\n1125,882\n1089,701\n1111,9\n221,417\n865,117\n470,708\n82,884\n1242,562\n393,597\n1278,555\n1160,791\n709,77\n47,539\n1059,603\n1284,341\n669,600\n572,532\n1213,365\n1029,632\n518,229\n1181,239\n999,208\n698,739\n982,316\n594,437\n338,816\n100,309\n283,332\n879,320\n22,859\n1193,355\n1005,838\n33,403\n214,366\n1235,471\n104,294\n465,197\n618,220\n443,77\n277,280\n1054,280\n1192,570\n715,350\n430,234\n1091,487\n731,647\n1202,492\n847,33\n436,626\n902,308\n164,130\n207,338\n316,140\n1191,786\n1093,478\n1066,337\n629,334\n1217,507\n699,338\n1196,177\n1230,553\n579,247\n1207,98\n373,565\n835,539\n1290,25\n249,470\n1290,354\n1203,319\n12,691\n937,651\n127,434\n1084,352\n393,297\n763,504\n959,256\n1193,658\n45,637\n865,341\n105,855\n1230,105\n1205,855\n1099,410\n150,791\n546,850\n1017,575\n227,787\n589,149\n611,194\n268,152\n518,665\n783,434\n7,805\n527,796\n1101,105\n681,260\n189,697\n937,537\n172,197\n1255,351\n999,579\n435,543\n520,201\n527,226\n868,378\n674,757\n699,668\n729,873\n1049,44\n992,869\n1268,739\n764,850\n288,269\n284,115\n1297,152\n692,565\n200,784\n816,355\n1232,688\n1026,536\n937,105\n537,635\n519,217\n1002,861\n398,719\n549,855\n622,126\n708,469\n117,632\n858,437\n878,819\n961,796\n979,437\n107,855\n853,239\n433,253\n783,460\n281,710\n659,121\n1258,238\n1175,814\n1103,338\n62,343\n848,693\n1196,269\n191,413\n495,666\n711,782\n129,491\n875,672\n53,789\n1033,280\n142,764\n467,893\n100,103\n326,673\n406,287\n1001,395\n1232,847\n289,700\n47,747\n749,835\n102,437\n1114,544\n208,341\n731,199\n44,665\n1140,329\n156,315\n479,843\n1300,399\n1140,763\n17,428\n843,431\n1061,393\n689,799\n35,845\n1232,240\n114,269\n179,355\n1268,358\n1168,764\n359,745\n366,493\n935,875\n301,782\n97,521\n701,861\n180,84\n1258,656\n554,800\n242,719\n175,499\n885,340\n431,768\n694,849\n678,819\n793,145\n406,607\n878,635\n1263,539\n196,863\n612,115\n430,10\n679,32\n200,170\n1066,553\n1300,175\n1113,575\n972,175\n151,619\n681,33\n622,717\n709,257\n1116,737\n783,12\n78,847\n442,602\n436,178\n348,660\n1041,501\n734,623\n965,843\n935,819\n662,96\n1061,162\n574,341\n1021,700\n\nfold along x=655\nfold along y=447\nfold along x=327\nfold along y=223\nfold along x=163\nfold along y=111\nfold along x=81\nfold along y=55\nfold along x=40\nfold along y=27\nfold along y=13\nfold along y=6\n"} -->

get the raw input here

```elixir
input = IO.getn("input", 999_999_999_999_999_999_999_999_999)
```

parse the input here

```elixir
[dots, folds] = String.split(input, "\n\n", trim: true)

dots =
  dots
  |> String.split("\n", trim: true)
  |> MapSet.new(fn coordinates ->
    coordinates
    |> String.split(",")
    |> Enum.map(&String.to_integer/1)
    |> List.to_tuple()
  end)

folds =
  folds
  |> String.split("\n", trim: true)
  |> Enum.map(fn "fold along " <> fold ->
    case fold do
      "x=" <> number -> {:x, String.to_integer(number)}
      "y=" <> number -> {:y, String.to_integer(number)}
    end
  end)

{dots, folds}
```

```elixir
print_dots = fn dots ->
  {width, _} = Enum.max_by(dots, fn {x, _} -> x end)
  {_, height} = Enum.max_by(dots, fn {_, y} -> y end)

  for y <- 0..height do
    for x <- 0..width do
      if MapSet.member?(dots, {x, y}) do
        IO.write("#")
      else
        IO.write(".")
      end
    end

    IO.puts("")
  end
end
```

## Part 1

```elixir
[fold | _] = folds

perform_fold = fn
  dots, {:x, column} ->
    right_dots = dots |> Enum.filter(fn {x, _} -> x > column end) |> MapSet.new()
    left_dots = MapSet.difference(dots, right_dots)

    right_dots
    |> Enum.map(fn {x, y} -> {column - (x - column), y} end)
    |> MapSet.new()
    |> MapSet.union(left_dots)

  dots, {:y, line} ->
    bottom_dots = dots |> Enum.filter(fn {_, y} -> y > line end) |> MapSet.new()
    top_dots = MapSet.difference(dots, bottom_dots)

    bottom_dots
    |> Enum.map(fn {x, y} -> {x, line - (y - line)} end)
    |> MapSet.new()
    |> MapSet.union(top_dots)
end

dots
|> perform_fold.(fold)
|> Enum.count()
```

## Part 2

```elixir
perform_fold = fn
  dots, {:x, column} ->
    right_dots = dots |> Enum.filter(fn {x, _} -> x > column end) |> MapSet.new()
    left_dots = MapSet.difference(dots, right_dots)

    right_dots
    |> Enum.map(fn {x, y} -> {column - (x - column), y} end)
    |> MapSet.new()
    |> MapSet.union(left_dots)

  dots, {:y, line} ->
    bottom_dots = dots |> Enum.filter(fn {_, y} -> y > line end) |> MapSet.new()
    top_dots = MapSet.difference(dots, bottom_dots)

    bottom_dots
    |> Enum.map(fn {x, y} -> {x, line - (y - line)} end)
    |> MapSet.new()
    |> MapSet.union(top_dots)
end

folds
|> Enum.reduce(dots, fn fold, dots -> perform_fold.(dots, fold) end)
|> print_dots.()
```
